/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MyPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var VIEW_TYPE_EASY_KEEP = "easy-keep-view";
var DEFAULT_SETTINGS = {
  mySetting: "default",
  notesDB: [],
  themeMode: "system",
  openAsHomepage: false
};
function resolveImageByName(app, imageName) {
  const target = imageName.replace(/\.(jpg|jpeg|png|webp)$/i, "").toLowerCase();
  const candidates = app.vault.getFiles().filter((f) => /\.(jpg|jpeg|png|webp)$/i.test(f.name));
  for (const file of candidates) {
    if (file.basename.toLowerCase() === target) {
      return file;
    }
  }
  return null;
}
function debounce(fn, delay = 300) {
  let timer;
  return (...args) => {
    clearTimeout(timer);
    timer = setTimeout(() => fn(...args), delay);
  };
}
var EasyKeepView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.plugin = plugin;
  }
  getViewType() {
    return VIEW_TYPE_EASY_KEEP;
  }
  getDisplayText() {
    return "Easy Keep View";
  }
  // Build the content of the view
  async buildContent() {
    this.mainContainer.empty();
    this.mainContainer.style.overflowY = "auto";
    this.mainContainer.style.height = "100%";
    const cardContainer = this.mainContainer.createDiv("easy-keep-cards-container");
    const newNoteCard = cardContainer.createDiv("easy-keep-card new-note-card");
    newNoteCard.createEl("h3", { text: "+" });
    newNoteCard.createEl("p", { text: "Add New Note" });
    newNoteCard.onclick = () => this.plugin.createNewNote();
    await this.plugin.refreshThumbnails();
    let notes = this.plugin.settings.notesDB.slice().sort((a, b) => b.time - a.time).slice(0, 100);
    if (notes.length) {
      notes.forEach((note) => {
        const card = cardContainer.createDiv("easy-keep-card");
        card.createEl("h3", { text: note.title });
        if (note.imageLink) {
          let file = this.app.metadataCache.getFirstLinkpathDest(note.imageLink, note.path);
          if (!(file instanceof import_obsidian.TFile)) {
            file = resolveImageByName(this.app, note.imageLink);
          }
          if (file instanceof import_obsidian.TFile) {
            const resourcePath = this.app.vault.getResourcePath(file);
            const img = card.createEl("img", { cls: "easy-keep-thumbnail" });
            img.src = resourcePath;
            img.onerror = () => {
              console.warn("[Easy Keep View] Failed to load thumbnail:", resourcePath);
              img.remove();
              if (note.excerpt)
                card.createEl("p", { text: note.excerpt });
            };
            img.onload = () => {
              console.log("[Easy Keep View] Thumbnail loaded:", resourcePath);
            };
          } else if (note.excerpt) {
            card.createEl("p", { text: note.excerpt });
          }
        } else {
          if (note.excerpt) {
            card.createEl("p", { text: note.excerpt });
          }
        }
        card.onclick = () => this.plugin.openNoteInNewTab(note.path);
      });
    } else {
      const noHistory = cardContainer.createDiv("no-history-message");
      noHistory.setText("No notes, create a new one!");
    }
  }
  async refreshContent() {
    await this.buildContent();
  }
  // Initialize view on open
  async onOpen() {
    this.mainContainer = this.containerEl;
    await this.plugin.loadSettings();
    await this.buildContent();
    this.loadCSS();
  }
  // Load custom CSS
  loadCSS() {
    const link = document.createElement("link");
    link.rel = "stylesheet";
    link.href = `${this.plugin.manifest.dir}/assets/styles.css`;
    document.head.appendChild(link);
  }
  async onClose() {
  }
};
var SampleSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Easy Keep View Plugin Settings" });
    new import_obsidian.Setting(containerEl).setName("Theme Mode").setDesc("Select a theme mode for the Easy Keep View").addDropdown((dropdown) => {
      dropdown.addOption("system", "System (adapt)");
      dropdown.addOption("light", "Light");
      dropdown.addOption("dark", "Dark");
      dropdown.setValue(this.plugin.settings.themeMode);
      dropdown.onChange(async (value) => {
        this.plugin.settings.themeMode = value;
        await this.plugin.saveSettings();
        this.plugin.refreshEasyKeepViewIfOpen();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Use Easy Keep View as Home Page").setDesc("Automatically open Easy Keep View when Obsidian starts").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.openAsHomepage);
      toggle.onChange(async (value) => {
        this.plugin.settings.openAsHomepage = value;
        await this.plugin.saveSettings();
        new Notice("Restart Obsidian to apply the homepage setting.");
      });
    });
  }
};
var MyPlugin = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.app.workspace.onLayoutReady(async () => {
      await this.cleanDatabase();
      this.refreshEasyKeepViewIfOpen();
      if (this.settings.openAsHomepage) {
        await this.activateEasyKeepView();
      }
    });
    this.registerView(VIEW_TYPE_EASY_KEEP, (leaf) => new EasyKeepView(leaf, this));
    const ribbonIconEl = this.addRibbonIcon("dice", "Easy Keep View", () => {
      this.activateEasyKeepView();
    });
    ribbonIconEl.addClass("my-plugin-ribbon-class");
    this.registerEvent(this.app.workspace.on("file-open", async (file) => {
      if (file) {
        await this.addToDatabase(file);
        this.refreshDebounced();
      }
    }));
    this.registerEvent(this.app.vault.on("delete", async (file) => {
      if (file instanceof import_obsidian.TFile) {
        await this.removeFromDatabase(file.path);
        this.refreshDebounced();
      }
    }));
    this.registerEvent(this.app.vault.on("rename", async (file, oldPath) => {
      if (file instanceof import_obsidian.TFile) {
        const entryIndex = this.settings.notesDB.findIndex((e) => e.path === oldPath);
        if (entryIndex !== -1) {
          this.settings.notesDB[entryIndex].path = file.path;
          this.settings.notesDB[entryIndex].title = file.basename;
          await this.saveSettings();
          this.refreshDebounced();
        }
      }
    }));
    this.registerEvent(this.app.vault.on("rename", async (file, oldPath) => {
      if (file instanceof import_obsidian.TFile && /\.(jpg|jpeg|png|webp)$/i.test(file.path)) {
        let updated = false;
        this.settings.notesDB.forEach((entry) => {
          if (entry.imageLink === oldPath) {
            entry.imageLink = file.path;
            updated = true;
          }
        });
        if (updated) {
          await this.saveSettings();
          this.refreshDebounced();
        }
      }
    }));
    this.registerEvent(this.app.vault.on("modify", async (file) => {
      if (file instanceof import_obsidian.TFile) {
        await this.addToDatabase(file);
        this.refreshDebounced();
      }
    }));
    this.refreshDebounced = debounce(() => this.refreshEasyKeepViewIfOpen(), 300);
    this.addSettingTab(new SampleSettingTab(this.app, this));
  }
  onunload() {
    this.app.workspace.detachLeavesOfType(VIEW_TYPE_EASY_KEEP);
  }
  // Activate the view
  async activateEasyKeepView() {
    const existingLeaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_EASY_KEEP);
    if (existingLeaves.length > 0) {
      this.app.workspace.revealLeaf(existingLeaves[0]);
      return;
    }
    const leaf = this.app.workspace.getLeaf(true);
    await leaf.setViewState({ type: VIEW_TYPE_EASY_KEEP, active: true });
    this.app.workspace.revealLeaf(leaf);
  }
  // Refresh the view if open
  async refreshEasyKeepViewIfOpen() {
    const existingLeaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_EASY_KEEP);
    if (existingLeaves.length > 0) {
      const view = existingLeaves[0].view;
      await view.refreshContent();
    }
  }
  // Refresh note thumbnails based on content
  // Refresh note thumbnails based on content
  async refreshThumbnails() {
    for (const note of this.settings.notesDB) {
      const file = this.app.vault.getAbstractFileByPath(note.path);
      if (!(file instanceof import_obsidian.TFile))
        continue;
      const content = await this.app.vault.cachedRead(file);
      const lines = content.trim().split("\n").filter((line) => line.trim() !== "");
      const firstLine = lines.find((line) => line.trim() !== "");
      let excerpt = "";
      let imageLink;
      if (firstLine && firstLine.includes("![[") && firstLine.includes("]]")) {
        excerpt = lines.slice(0, 1).join(" ");
      } else {
        if (firstLine) {
          excerpt = firstLine;
          if (lines.length > 1)
            excerpt += " \u2026";
        }
        const match = content.match(/!\[\[([^\]]+)\]\]/);
        if (match) {
          imageLink = match[1].trim();
          if (imageLink && note.imageLink !== imageLink) {
            note.imageLink = imageLink;
          }
        }
      }
      if (imageLink) {
        note.imageLink = imageLink;
      }
      if (excerpt) {
        note.excerpt = excerpt;
      }
    }
    await this.saveSettings();
  }
  // Add note to the database
  async addToDatabase(file) {
    var _a;
    const content = await this.app.vault.cachedRead(file);
    const lines = content.trim().split("\n").filter((line) => line.trim() !== "");
    let excerpt = "";
    let imageLink;
    if (/\.(jpg|jpeg|png|webp)$/i.test(file.path)) {
      imageLink = file.path;
    } else {
      const obsidianEmbedMatch = content.match(/!\[\[([^\]]+)\]\]/);
      const markdownImageMatch = content.match(/!\[.*?\]\((.*?)\)/);
      if (obsidianEmbedMatch || markdownImageMatch) {
        imageLink = (_a = (obsidianEmbedMatch == null ? void 0 : obsidianEmbedMatch[1]) || (markdownImageMatch == null ? void 0 : markdownImageMatch[1])) == null ? void 0 : _a.trim();
      }
    }
    if (!imageLink && lines.length > 0) {
      excerpt = lines.slice(0, 2).join(" ");
      if (lines.length > 2)
        excerpt = excerpt.trim() + " \u2026";
    }
    const titleWithoutExt = file.name.replace(/\.(md|png|jpg|jpeg|webp)$/i, "");
    const newEntry = {
      path: file.path,
      title: titleWithoutExt,
      excerpt,
      time: Date.now(),
      imageLink
    };
    this.settings.notesDB = this.settings.notesDB.filter((entry) => entry.path !== file.path);
    this.settings.notesDB.unshift(newEntry);
    await this.saveSettings();
  }
  // Remove note from the database
  async removeFromDatabase(filePath) {
    const initialLength = this.settings.notesDB.length;
    this.settings.notesDB = this.settings.notesDB.filter((entry) => entry.path !== filePath);
    if (this.settings.notesDB.length !== initialLength) {
      await this.saveSettings();
    }
  }
  // Clean up the database by removing notes that no longer exist
  async cleanDatabase() {
    const files = this.app.vault.getMarkdownFiles();
    const existingPaths = new Set(files.map((file) => file.path));
    this.settings.notesDB = this.settings.notesDB.filter((entry) => existingPaths.has(entry.path));
    await this.saveSettings();
  }
  // Open a note in a new tab
  async openNoteInNewTab(filePath) {
    const file = this.app.vault.getAbstractFileByPath(filePath);
    if (!(file instanceof import_obsidian.TFile))
      return;
    let existingLeaf = null;
    this.app.workspace.iterateAllLeaves((leaf) => {
      var _a;
      if (leaf.view.getViewType() === "markdown" && ((_a = leaf.view.file) == null ? void 0 : _a.path) === filePath) {
        existingLeaf = leaf;
      }
    });
    if (existingLeaf) {
      this.app.workspace.setActiveLeaf(existingLeaf, { focus: true });
    } else {
      const newLeaf = this.app.workspace.getLeaf(true);
      await newLeaf.openFile(file);
      this.app.workspace.setActiveLeaf(newLeaf, { focus: true });
    }
  }
  // Load settings from storage
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  // Save settings to storage
  async saveSettings() {
    await this.saveData(this.settings);
  }
  // Generate a unique name for an untitled note
  generateUniqueUntitledName() {
    const baseName = "Untitled";
    const files = this.app.vault.getMarkdownFiles();
    const existingNames = new Set(files.map((f) => f.basename));
    if (!existingNames.has(baseName)) {
      return baseName;
    }
    let counter = 1;
    while (existingNames.has(`${baseName} ${counter}`)) {
      counter++;
    }
    return `${baseName} ${counter}`;
  }
  // Create a new note
  async createNewNote() {
    const title = this.generateUniqueUntitledName();
    const filePath = `${title}.md`;
    const file = await this.app.vault.create(filePath, "");
    await this.addToDatabase(file);
    this.openNoteInNewTab(filePath);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcblx0QXBwLFxuXHRQbHVnaW4sXG5cdFdvcmtzcGFjZUxlYWYsXG5cdEl0ZW1WaWV3LFxuXHRURmlsZSxcblx0UGx1Z2luU2V0dGluZ1RhYixcblx0U2V0dGluZyxcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmltcG9ydCBcIi4vc3R5bGVzLmNzc1wiO1xuXG5jb25zdCBWSUVXX1RZUEVfRUFTWV9LRUVQID0gXCJlYXN5LWtlZXAtdmlld1wiO1xuXG5pbnRlcmZhY2UgTm90ZUVudHJ5IHtcblx0cGF0aDogc3RyaW5nO1xuXHR0aXRsZTogc3RyaW5nO1xuXHRleGNlcnB0OiBzdHJpbmc7XG5cdHRpbWU6IG51bWJlcjtcblx0aW1hZ2VMaW5rPzogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgTXlQbHVnaW5TZXR0aW5ncyB7XG5cdG15U2V0dGluZzogc3RyaW5nO1xuXHRub3Rlc0RCOiBOb3RlRW50cnlbXTtcblx0dGhlbWVNb2RlOiBcInN5c3RlbVwiIHwgXCJsaWdodFwiIHwgXCJkYXJrXCI7XG5cdG9wZW5Bc0hvbWVwYWdlOiBib29sZWFuO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBNeVBsdWdpblNldHRpbmdzID0ge1xuXHRteVNldHRpbmc6IFwiZGVmYXVsdFwiLFxuXHRub3Rlc0RCOiBbXSxcblx0dGhlbWVNb2RlOiBcInN5c3RlbVwiLFxuXHRvcGVuQXNIb21lcGFnZTogZmFsc2UsXG59O1xuXG5cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHJlc29sdmUgaW1hZ2UgYnkgbmFtZVxuZnVuY3Rpb24gcmVzb2x2ZUltYWdlQnlOYW1lKGFwcDogQXBwLCBpbWFnZU5hbWU6IHN0cmluZyk6IFRGaWxlIHwgbnVsbCB7XG5cdGNvbnN0IHRhcmdldCA9IGltYWdlTmFtZS5yZXBsYWNlKC9cXC4oanBnfGpwZWd8cG5nfHdlYnApJC9pLCBcIlwiKS50b0xvd2VyQ2FzZSgpO1xuXHRjb25zdCBjYW5kaWRhdGVzID0gYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKGYgPT4gL1xcLihqcGd8anBlZ3xwbmd8d2VicCkkL2kudGVzdChmLm5hbWUpKTtcblx0Zm9yIChjb25zdCBmaWxlIG9mIGNhbmRpZGF0ZXMpIHtcblx0XHRpZiAoZmlsZS5iYXNlbmFtZS50b0xvd2VyQ2FzZSgpID09PSB0YXJnZXQpIHtcblx0XHRcdHJldHVybiBmaWxlO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gbnVsbDtcbn1cblxuLy8gRGVib3VuY2UgZnVuY3Rpb24gZm9yIHRocm90dGxpbmcgdXBkYXRlc1xuZnVuY3Rpb24gZGVib3VuY2UoZm46ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCwgZGVsYXkgPSAzMDApOiAoLi4uYXJnczogYW55W10pID0+IHZvaWQge1xuXHRsZXQgdGltZXI6IE5vZGVKUy5UaW1lb3V0O1xuXHRyZXR1cm4gKC4uLmFyZ3M6IGFueVtdKSA9PiB7XG5cdFx0Y2xlYXJUaW1lb3V0KHRpbWVyKTtcblx0XHR0aW1lciA9IHNldFRpbWVvdXQoKCkgPT4gZm4oLi4uYXJncyksIGRlbGF5KTtcblx0fTtcbn1cblxuY2xhc3MgRWFzeUtlZXBWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuXHRwbHVnaW46IE15UGx1Z2luO1xuXHRwcml2YXRlIG1haW5Db250YWluZXI6IEhUTUxFbGVtZW50O1xuXG5cdGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogTXlQbHVnaW4pIHtcblx0XHRzdXBlcihsZWFmKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGdldFZpZXdUeXBlKCk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIFZJRVdfVFlQRV9FQVNZX0tFRVA7XG5cdH1cblxuXHRnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xuXHRcdHJldHVybiBcIkVhc3kgS2VlcCBWaWV3XCI7XG5cdH1cblxuXHQvLyBCdWlsZCB0aGUgY29udGVudCBvZiB0aGUgdmlld1xuXHRhc3luYyBidWlsZENvbnRlbnQoKSB7XG5cdFx0dGhpcy5tYWluQ29udGFpbmVyLmVtcHR5KCk7XG5cdFx0dGhpcy5tYWluQ29udGFpbmVyLnN0eWxlLm92ZXJmbG93WSA9IFwiYXV0b1wiO1xuXHRcdHRoaXMubWFpbkNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcblxuXHRcdGNvbnN0IGNhcmRDb250YWluZXIgPSB0aGlzLm1haW5Db250YWluZXIuY3JlYXRlRGl2KFwiZWFzeS1rZWVwLWNhcmRzLWNvbnRhaW5lclwiKTtcblxuXHRcdC8vIE5ldyBOb3RlIENhcmRcblx0XHRjb25zdCBuZXdOb3RlQ2FyZCA9IGNhcmRDb250YWluZXIuY3JlYXRlRGl2KFwiZWFzeS1rZWVwLWNhcmQgbmV3LW5vdGUtY2FyZFwiKTtcblx0XHRuZXdOb3RlQ2FyZC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogXCIrXCIgfSk7XG5cdFx0bmV3Tm90ZUNhcmQuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJBZGQgTmV3IE5vdGVcIiB9KTtcblx0XHRuZXdOb3RlQ2FyZC5vbmNsaWNrID0gKCkgPT4gdGhpcy5wbHVnaW4uY3JlYXRlTmV3Tm90ZSgpO1xuXG5cdFx0Ly8gQmVmb3JlIGJ1aWxkaW5nIGNhcmRzLCByZWZyZXNoIHRodW1ibmFpbHMgZnJvbSBub3RlIGNvbnRlbnQuXG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4ucmVmcmVzaFRodW1ibmFpbHMoKTtcblxuXHRcdGxldCBub3RlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLm5vdGVzREIuc2xpY2UoKVxuXHRcdC5zb3J0KChhLCBiKSA9PiBiLnRpbWUgLSBhLnRpbWUpXG5cdFx0LnNsaWNlKDAsIDEwMCk7XG5cblx0XHRpZiAobm90ZXMubGVuZ3RoKSB7XG5cdFx0XHRub3Rlcy5mb3JFYWNoKG5vdGUgPT4ge1xuXHRcdFx0XHRjb25zdCBjYXJkID0gY2FyZENvbnRhaW5lci5jcmVhdGVEaXYoXCJlYXN5LWtlZXAtY2FyZFwiKTtcblx0XHRcdFx0Y2FyZC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogbm90ZS50aXRsZSB9KTtcblxuXHRcdFx0XHQvLyBTaG93IHRodW1ibmFpbCBpZiBpbWFnZUxpbmsgaXMgYXZhaWxhYmxlLCBvdGhlcndpc2Ugc2hvdyBleGNlcnB0XG5cdFx0XHRcdGlmIChub3RlLmltYWdlTGluaykge1xuXHRcdFx0XHRcdGxldCBmaWxlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChub3RlLmltYWdlTGluaywgbm90ZS5wYXRoKTtcblx0XHRcdFx0XHRpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdFx0XHRmaWxlID0gcmVzb2x2ZUltYWdlQnlOYW1lKHRoaXMuYXBwLCBub3RlLmltYWdlTGluayk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdFx0XHRcdGNvbnN0IHJlc291cmNlUGF0aCA9IHRoaXMuYXBwLnZhdWx0LmdldFJlc291cmNlUGF0aChmaWxlKTtcblx0XHRcdFx0XHRcdGNvbnN0IGltZyA9IGNhcmQuY3JlYXRlRWwoXCJpbWdcIiwgeyBjbHM6IFwiZWFzeS1rZWVwLXRodW1ibmFpbFwiIH0pO1xuXHRcdFx0XHRcdFx0aW1nLnNyYyA9IHJlc291cmNlUGF0aDtcblx0XHRcdFx0XHRcdGltZy5vbmVycm9yID0gKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJbRWFzeSBLZWVwIFZpZXddIEZhaWxlZCB0byBsb2FkIHRodW1ibmFpbDpcIiwgcmVzb3VyY2VQYXRoKTtcblx0XHRcdFx0XHRcdFx0aW1nLnJlbW92ZSgpO1xuXHRcdFx0XHRcdFx0XHRpZiAobm90ZS5leGNlcnB0KSBjYXJkLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IG5vdGUuZXhjZXJwdCB9KTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRpbWcub25sb2FkID0gKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIltFYXN5IEtlZXAgVmlld10gVGh1bWJuYWlsIGxvYWRlZDpcIiwgcmVzb3VyY2VQYXRoKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChub3RlLmV4Y2VycHQpIHtcblx0XHRcdFx0XHRcdGNhcmQuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogbm90ZS5leGNlcnB0IH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBJZiBubyBpbWFnZSBsaW5rLCBzaG93IHRoZSBleGNlcnB0IGluc3RlYWRcblx0XHRcdFx0XHRpZiAobm90ZS5leGNlcnB0KSB7XG5cdFx0XHRcdFx0XHRjYXJkLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IG5vdGUuZXhjZXJwdCB9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjYXJkLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnBsdWdpbi5vcGVuTm90ZUluTmV3VGFiKG5vdGUucGF0aCk7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3Qgbm9IaXN0b3J5ID0gY2FyZENvbnRhaW5lci5jcmVhdGVEaXYoXCJuby1oaXN0b3J5LW1lc3NhZ2VcIik7XG5cdFx0XHRub0hpc3Rvcnkuc2V0VGV4dChcIk5vIG5vdGVzLCBjcmVhdGUgYSBuZXcgb25lIVwiKTtcblx0XHR9XG5cdH1cblxuXG5cblx0YXN5bmMgcmVmcmVzaENvbnRlbnQoKSB7XG5cdFx0YXdhaXQgdGhpcy5idWlsZENvbnRlbnQoKTtcblx0fVxuXG5cdC8vIEluaXRpYWxpemUgdmlldyBvbiBvcGVuXG5cdGFzeW5jIG9uT3BlbigpIHtcblx0XHR0aGlzLm1haW5Db250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsO1xuXG5cdFx0Ly8gV2FpdCB1bnRpbCBwbHVnaW4gc2V0dGluZ3MgYXJlIGxvYWRlZFxuXHRcdGF3YWl0IHRoaXMucGx1Z2luLmxvYWRTZXR0aW5ncygpO1xuXG5cdFx0Ly8gQnVpbGQgY29udGVudCBhZnRlciBzZXR0aW5ncyBhcmUgcmVhZHlcblx0XHRhd2FpdCB0aGlzLmJ1aWxkQ29udGVudCgpO1xuXG5cdFx0dGhpcy5sb2FkQ1NTKCk7XG5cdH1cblxuXHQvLyBMb2FkIGN1c3RvbSBDU1Ncblx0bG9hZENTUygpIHtcblx0XHRjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XG5cdFx0bGluay5yZWwgPSBcInN0eWxlc2hlZXRcIjtcblx0XHRsaW5rLmhyZWYgPSBgJHt0aGlzLnBsdWdpbi5tYW5pZmVzdC5kaXJ9L2Fzc2V0cy9zdHlsZXMuY3NzYDtcblx0XHRkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGxpbmspO1xuXHR9XG5cblx0YXN5bmMgb25DbG9zZSgpIHt9XG59XG5cbi8vIFBsdWdpbiBzZXR0aW5ncyB0YWJcbmNsYXNzIFNhbXBsZVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBNeVBsdWdpbjtcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTXlQbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHRjb250YWluZXJFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJFYXN5IEtlZXAgVmlldyBQbHVnaW4gU2V0dGluZ3NcIiB9KTtcblxuXHRcdC8vIFRoZW1lIG1vZGUgc2VsZWN0b3Jcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHQuc2V0TmFtZShcIlRoZW1lIE1vZGVcIilcblx0XHQuc2V0RGVzYyhcIlNlbGVjdCBhIHRoZW1lIG1vZGUgZm9yIHRoZSBFYXN5IEtlZXAgVmlld1wiKVxuXHRcdC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24oXCJzeXN0ZW1cIiwgXCJTeXN0ZW0gKGFkYXB0KVwiKTtcblx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihcImxpZ2h0XCIsIFwiTGlnaHRcIik7XG5cdFx0XHRkcm9wZG93bi5hZGRPcHRpb24oXCJkYXJrXCIsIFwiRGFya1wiKTtcblx0XHRcdGRyb3Bkb3duLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnRoZW1lTW9kZSk7XG5cdFx0XHRkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWU6IFwic3lzdGVtXCIgfCBcImxpZ2h0XCIgfCBcImRhcmtcIikgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy50aGVtZU1vZGUgPSB2YWx1ZTtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnJlZnJlc2hFYXN5S2VlcFZpZXdJZk9wZW4oKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gSG9tZXBhZ2UgdG9nZ2xlXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0LnNldE5hbWUoXCJVc2UgRWFzeSBLZWVwIFZpZXcgYXMgSG9tZSBQYWdlXCIpXG5cdFx0LnNldERlc2MoXCJBdXRvbWF0aWNhbGx5IG9wZW4gRWFzeSBLZWVwIFZpZXcgd2hlbiBPYnNpZGlhbiBzdGFydHNcIilcblx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB7XG5cdFx0XHR0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbkFzSG9tZXBhZ2UpO1xuXHRcdFx0dG9nZ2xlLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuQXNIb21lcGFnZSA9IHZhbHVlO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0bmV3IE5vdGljZShcIlJlc3RhcnQgT2JzaWRpYW4gdG8gYXBwbHkgdGhlIGhvbWVwYWdlIHNldHRpbmcuXCIpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cbn1cblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNeVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBNeVBsdWdpblNldHRpbmdzO1xuXHRwcml2YXRlIHJlZnJlc2hEZWJvdW5jZWQ6ICgpID0+IHZvaWQ7XG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0Ly8gRGVmZXIgY2xlYW5EYXRhYmFzZSB1bnRpbCB2YXVsdCBpcyByZWFkeVxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KGFzeW5jICgpID0+IHtcblx0XHRcdGF3YWl0IHRoaXMuY2xlYW5EYXRhYmFzZSgpO1xuXHRcdFx0dGhpcy5yZWZyZXNoRWFzeUtlZXBWaWV3SWZPcGVuKCk7XG5cblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLm9wZW5Bc0hvbWVwYWdlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYWN0aXZhdGVFYXN5S2VlcFZpZXcoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXG5cdFx0dGhpcy5yZWdpc3RlclZpZXcoVklFV19UWVBFX0VBU1lfS0VFUCwgKGxlYWYpID0+IG5ldyBFYXN5S2VlcFZpZXcobGVhZiwgdGhpcykpO1xuXG5cdFx0Y29uc3QgcmliYm9uSWNvbkVsID0gdGhpcy5hZGRSaWJib25JY29uKFwiZGljZVwiLCBcIkVhc3kgS2VlcCBWaWV3XCIsICgpID0+IHtcblx0XHRcdHRoaXMuYWN0aXZhdGVFYXN5S2VlcFZpZXcoKTtcblx0XHR9KTtcblx0XHRyaWJib25JY29uRWwuYWRkQ2xhc3MoXCJteS1wbHVnaW4tcmliYm9uLWNsYXNzXCIpO1xuXG5cdFx0Ly8gUmVmcmVzaCBvbiBmaWxlLW9wZW4gZXZlbnRzLlxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJmaWxlLW9wZW5cIiwgYXN5bmMgKGZpbGUpID0+IHtcblx0XHRcdGlmIChmaWxlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYWRkVG9EYXRhYmFzZShmaWxlKTtcblx0XHRcdFx0dGhpcy5yZWZyZXNoRGVib3VuY2VkKCk7XG5cdFx0XHR9XG5cdFx0fSkpO1xuXG5cdFx0Ly8gUmVmcmVzaCBvbiBmaWxlIGRlbGV0aW9uLlxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC52YXVsdC5vbihcImRlbGV0ZVwiLCBhc3luYyAoZmlsZSkgPT4ge1xuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnJlbW92ZUZyb21EYXRhYmFzZShmaWxlLnBhdGgpO1xuXHRcdFx0XHR0aGlzLnJlZnJlc2hEZWJvdW5jZWQoKTtcblx0XHRcdH1cblx0XHR9KSk7XG5cblx0XHQvLyBSZWZyZXNoIG9uIGZpbGUgcmVuYW1lIGZvciBub3Rlcy5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAudmF1bHQub24oXCJyZW5hbWVcIiwgYXN5bmMgKGZpbGUsIG9sZFBhdGgpID0+IHtcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdFx0Y29uc3QgZW50cnlJbmRleCA9IHRoaXMuc2V0dGluZ3Mubm90ZXNEQi5maW5kSW5kZXgoZSA9PiBlLnBhdGggPT09IG9sZFBhdGgpO1xuXHRcdFx0XHRpZiAoZW50cnlJbmRleCAhPT0gLTEpIHtcblx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLm5vdGVzREJbZW50cnlJbmRleF0ucGF0aCA9IGZpbGUucGF0aDtcblx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLm5vdGVzREJbZW50cnlJbmRleF0udGl0bGUgPSBmaWxlLmJhc2VuYW1lO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0dGhpcy5yZWZyZXNoRGVib3VuY2VkKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KSk7XG5cblx0XHQvLyBSZWZyZXNoIG9uIGZpbGUgcmVuYW1lIGZvciBpbWFnZSBmaWxlcy5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAudmF1bHQub24oXCJyZW5hbWVcIiwgYXN5bmMgKGZpbGUsIG9sZFBhdGgpID0+IHtcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgL1xcLihqcGd8anBlZ3xwbmd8d2VicCkkL2kudGVzdChmaWxlLnBhdGgpKSB7XG5cdFx0XHRcdGxldCB1cGRhdGVkID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMuc2V0dGluZ3Mubm90ZXNEQi5mb3JFYWNoKGVudHJ5ID0+IHtcblx0XHRcdFx0XHRpZiAoZW50cnkuaW1hZ2VMaW5rID09PSBvbGRQYXRoKSB7XG5cdFx0XHRcdFx0XHRlbnRyeS5pbWFnZUxpbmsgPSBmaWxlLnBhdGg7XG5cdFx0XHRcdFx0XHR1cGRhdGVkID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAodXBkYXRlZCkge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0dGhpcy5yZWZyZXNoRGVib3VuY2VkKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KSk7XG5cblx0XHQvLyBOZXc6IExpc3RlbiBmb3IgbW9kaWZ5IGV2ZW50cyB0byB1cGRhdGUgdGh1bWJuYWlsIGluZm8gd2hlbiBub3RlIGNvbnRlbnQgY2hhbmdlcy5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAudmF1bHQub24oXCJtb2RpZnlcIiwgYXN5bmMgKGZpbGUpID0+IHtcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5hZGRUb0RhdGFiYXNlKGZpbGUpO1xuXHRcdFx0XHR0aGlzLnJlZnJlc2hEZWJvdW5jZWQoKTtcblx0XHRcdH1cblx0XHR9KSk7XG5cblx0XHQvLyBJbml0aWFsaXplIGRlYm91bmNlIGZvciByZWZyZXNoIGNhbGxzLlxuXHRcdHRoaXMucmVmcmVzaERlYm91bmNlZCA9IGRlYm91bmNlKCgpID0+IHRoaXMucmVmcmVzaEVhc3lLZWVwVmlld0lmT3BlbigpLCAzMDApO1xuXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTYW1wbGVTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuZGV0YWNoTGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9FQVNZX0tFRVApO1xuXHR9XG5cblx0Ly8gQWN0aXZhdGUgdGhlIHZpZXdcblx0YXN5bmMgYWN0aXZhdGVFYXN5S2VlcFZpZXcoKSB7XG5cdFx0Y29uc3QgZXhpc3RpbmdMZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9FQVNZX0tFRVApO1xuXHRcdGlmIChleGlzdGluZ0xlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihleGlzdGluZ0xlYXZlc1swXSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKHRydWUpO1xuXHRcdGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHsgdHlwZTogVklFV19UWVBFX0VBU1lfS0VFUCwgYWN0aXZlOiB0cnVlIH0pO1xuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXHR9XG5cblx0Ly8gUmVmcmVzaCB0aGUgdmlldyBpZiBvcGVuXG5cdGFzeW5jIHJlZnJlc2hFYXN5S2VlcFZpZXdJZk9wZW4oKSB7XG5cdFx0Y29uc3QgZXhpc3RpbmdMZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9FQVNZX0tFRVApO1xuXHRcdGlmIChleGlzdGluZ0xlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRjb25zdCB2aWV3ID0gZXhpc3RpbmdMZWF2ZXNbMF0udmlldyBhcyBFYXN5S2VlcFZpZXc7XG5cdFx0XHRhd2FpdCB2aWV3LnJlZnJlc2hDb250ZW50KCk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gUmVmcmVzaCBub3RlIHRodW1ibmFpbHMgYmFzZWQgb24gY29udGVudFxuXHQvLyBSZWZyZXNoIG5vdGUgdGh1bWJuYWlscyBiYXNlZCBvbiBjb250ZW50XG5cdGFzeW5jIHJlZnJlc2hUaHVtYm5haWxzKCkge1xuXHRcdGZvciAoY29uc3Qgbm90ZSBvZiB0aGlzLnNldHRpbmdzLm5vdGVzREIpIHtcblx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm90ZS5wYXRoKTtcblx0XHRcdGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIGNvbnRpbnVlO1xuXG5cdFx0XHRjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKTtcblx0XHRcdGNvbnN0IGxpbmVzID0gY29udGVudC50cmltKCkuc3BsaXQoXCJcXG5cIikuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkgIT09IFwiXCIpO1xuXG5cdFx0XHQvLyBHZXQgdGhlIGZpcnN0IG5vbi1lbXB0eSBsaW5lIChjb250ZW50IG9yIGltYWdlKVxuXHRcdFx0Y29uc3QgZmlyc3RMaW5lID0gbGluZXMuZmluZChsaW5lID0+IGxpbmUudHJpbSgpICE9PSBcIlwiKTtcblxuXHRcdFx0bGV0IGV4Y2VycHQgPSBcIlwiO1xuXHRcdFx0bGV0IGltYWdlTGluazogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG5cdFx0XHQvLyBJZiB0aGUgZmlyc3QgbGluZSBjb250YWlucyBhbiBlbWJlZGRlZCBpbWFnZSwgZG9uJ3Qgc2hvdyB0aGUgdGh1bWJuYWlsLCBqdXN0IHRleHRcblx0XHRcdGlmIChmaXJzdExpbmUgJiYgZmlyc3RMaW5lLmluY2x1ZGVzKFwiIVtbXCIpICYmIGZpcnN0TGluZS5pbmNsdWRlcyhcIl1dXCIpKSB7XG5cdFx0XHRcdC8vIEV4Y2VycHQgc2hvdWxkIGp1c3QgYmUgdGhlIGNvbnRlbnQgdGV4dCBiZWZvcmUgdGhlIGltYWdlIGxpbmtcblx0XHRcdFx0ZXhjZXJwdCA9IGxpbmVzLnNsaWNlKDAsIDEpLmpvaW4oXCIgXCIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gQ3JlYXRlIGV4Y2VycHQgZnJvbSBmaXJzdCBsaW5lcyAodXAgdG8gMiBsaW5lcyBvZiBjb250ZW50KVxuXHRcdFx0XHRpZiAoZmlyc3RMaW5lKSB7XG5cdFx0XHRcdFx0ZXhjZXJwdCA9IGZpcnN0TGluZTtcblx0XHRcdFx0XHRpZiAobGluZXMubGVuZ3RoID4gMSkgZXhjZXJwdCArPSBcIiBcXHUyMDI2XCI7IC8vIEFkZCBlbGxpcHNpcyBpZiB0aGVyZSBhcmUgbW9yZSBsaW5lc1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgYW4gaW1hZ2UgaXMgZW1iZWRkZWQgYW55d2hlcmUgZWxzZSBpbiB0aGUgY29udGVudCAobm90IGp1c3QgdGhlIGZpcnN0IGxpbmUpXG5cdFx0XHRcdGNvbnN0IG1hdGNoID0gY29udGVudC5tYXRjaCgvIVxcW1xcWyhbXlxcXV0rKVxcXVxcXS8pO1xuXHRcdFx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdFx0XHRpbWFnZUxpbmsgPSBtYXRjaFsxXS50cmltKCk7XG5cdFx0XHRcdFx0aWYgKGltYWdlTGluayAmJiBub3RlLmltYWdlTGluayAhPT0gaW1hZ2VMaW5rKSB7XG5cdFx0XHRcdFx0XHRub3RlLmltYWdlTGluayA9IGltYWdlTGluaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gVXBkYXRlIHRoZSBub3RlIHdpdGggZXhjZXJwdCBhbmQgaW1hZ2VMaW5rIGlmIGZvdW5kXG5cdFx0XHRpZiAoaW1hZ2VMaW5rKSB7XG5cdFx0XHRcdG5vdGUuaW1hZ2VMaW5rID0gaW1hZ2VMaW5rO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZXhjZXJwdCkge1xuXHRcdFx0XHRub3RlLmV4Y2VycHQgPSBleGNlcnB0O1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG5cdH1cblxuXG5cblx0Ly8gQWRkIG5vdGUgdG8gdGhlIGRhdGFiYXNlXG5cdGFzeW5jIGFkZFRvRGF0YWJhc2UoZmlsZTogVEZpbGUpIHtcblx0XHRjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKTtcblx0XHRjb25zdCBsaW5lcyA9IGNvbnRlbnQudHJpbSgpLnNwbGl0KFwiXFxuXCIpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpICE9PSBcIlwiKTtcblx0XHRsZXQgZXhjZXJwdCA9IFwiXCI7XG5cdFx0bGV0IGltYWdlTGluazogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG5cdFx0aWYgKC9cXC4oanBnfGpwZWd8cG5nfHdlYnApJC9pLnRlc3QoZmlsZS5wYXRoKSkge1xuXHRcdFx0aW1hZ2VMaW5rID0gZmlsZS5wYXRoO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBvYnNpZGlhbkVtYmVkTWF0Y2ggPSBjb250ZW50Lm1hdGNoKC8hXFxbXFxbKFteXFxdXSspXFxdXFxdLyk7XG5cdFx0XHRjb25zdCBtYXJrZG93bkltYWdlTWF0Y2ggPSBjb250ZW50Lm1hdGNoKC8hXFxbLio/XFxdXFwoKC4qPylcXCkvKTtcblx0XHRcdGlmIChvYnNpZGlhbkVtYmVkTWF0Y2ggfHwgbWFya2Rvd25JbWFnZU1hdGNoKSB7XG5cdFx0XHRcdGltYWdlTGluayA9IChvYnNpZGlhbkVtYmVkTWF0Y2g/LlsxXSB8fCBtYXJrZG93bkltYWdlTWF0Y2g/LlsxXSk/LnRyaW0oKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIWltYWdlTGluayAmJiBsaW5lcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRleGNlcnB0ID0gbGluZXMuc2xpY2UoMCwgMikuam9pbihcIiBcIik7XG5cdFx0XHRpZiAobGluZXMubGVuZ3RoID4gMikgZXhjZXJwdCA9IGV4Y2VycHQudHJpbSgpICsgXCIgXHUyMDI2XCI7XG5cdFx0fVxuXG5cdFx0Y29uc3QgdGl0bGVXaXRob3V0RXh0ID0gZmlsZS5uYW1lLnJlcGxhY2UoL1xcLihtZHxwbmd8anBnfGpwZWd8d2VicCkkL2ksIFwiXCIpO1xuXHRcdGNvbnN0IG5ld0VudHJ5OiBOb3RlRW50cnkgPSB7XG5cdFx0XHRwYXRoOiBmaWxlLnBhdGgsXG5cdFx0XHR0aXRsZTogdGl0bGVXaXRob3V0RXh0LFxuXHRcdFx0ZXhjZXJwdCxcblx0XHRcdHRpbWU6IERhdGUubm93KCksXG5cdFx0XHRpbWFnZUxpbmssXG5cdFx0fTtcblxuXHRcdHRoaXMuc2V0dGluZ3Mubm90ZXNEQiA9IHRoaXMuc2V0dGluZ3Mubm90ZXNEQi5maWx0ZXIoZW50cnkgPT4gZW50cnkucGF0aCAhPT0gZmlsZS5wYXRoKTtcblx0XHR0aGlzLnNldHRpbmdzLm5vdGVzREIudW5zaGlmdChuZXdFbnRyeSk7XG5cdFx0YXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0fVxuXG5cdC8vIFJlbW92ZSBub3RlIGZyb20gdGhlIGRhdGFiYXNlXG5cdGFzeW5jIHJlbW92ZUZyb21EYXRhYmFzZShmaWxlUGF0aDogc3RyaW5nKSB7XG5cdFx0Y29uc3QgaW5pdGlhbExlbmd0aCA9IHRoaXMuc2V0dGluZ3Mubm90ZXNEQi5sZW5ndGg7XG5cdFx0dGhpcy5zZXR0aW5ncy5ub3Rlc0RCID0gdGhpcy5zZXR0aW5ncy5ub3Rlc0RCLmZpbHRlcihlbnRyeSA9PiBlbnRyeS5wYXRoICE9PSBmaWxlUGF0aCk7XG5cdFx0aWYgKHRoaXMuc2V0dGluZ3Mubm90ZXNEQi5sZW5ndGggIT09IGluaXRpYWxMZW5ndGgpIHtcblx0XHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gQ2xlYW4gdXAgdGhlIGRhdGFiYXNlIGJ5IHJlbW92aW5nIG5vdGVzIHRoYXQgbm8gbG9uZ2VyIGV4aXN0XG5cdGFzeW5jIGNsZWFuRGF0YWJhc2UoKSB7XG5cdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0Y29uc3QgZXhpc3RpbmdQYXRocyA9IG5ldyBTZXQoZmlsZXMubWFwKGZpbGUgPT4gZmlsZS5wYXRoKSk7XG5cdFx0dGhpcy5zZXR0aW5ncy5ub3Rlc0RCID0gdGhpcy5zZXR0aW5ncy5ub3Rlc0RCLmZpbHRlcihlbnRyeSA9PiBleGlzdGluZ1BhdGhzLmhhcyhlbnRyeS5wYXRoKSk7XG5cdFx0YXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0fVxuXG5cdC8vIE9wZW4gYSBub3RlIGluIGEgbmV3IHRhYlxuXHRhc3luYyBvcGVuTm90ZUluTmV3VGFiKGZpbGVQYXRoOiBzdHJpbmcpIHtcblx0XHRjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblx0XHRpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSByZXR1cm47XG5cdFx0bGV0IGV4aXN0aW5nTGVhZjogV29ya3NwYWNlTGVhZiB8IG51bGwgPSBudWxsO1xuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5pdGVyYXRlQWxsTGVhdmVzKGxlYWYgPT4ge1xuXHRcdFx0aWYgKGxlYWYudmlldy5nZXRWaWV3VHlwZSgpID09PSBcIm1hcmtkb3duXCIgJiYgKGxlYWYudmlldyBhcyBhbnkpLmZpbGU/LnBhdGggPT09IGZpbGVQYXRoKSB7XG5cdFx0XHRcdGV4aXN0aW5nTGVhZiA9IGxlYWY7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0aWYgKGV4aXN0aW5nTGVhZikge1xuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYoZXhpc3RpbmdMZWFmLCB7IGZvY3VzOiB0cnVlIH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBuZXdMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYodHJ1ZSk7XG5cdFx0XHRhd2FpdCBuZXdMZWFmLm9wZW5GaWxlKGZpbGUpO1xuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYobmV3TGVhZiwgeyBmb2N1czogdHJ1ZSB9KTtcblx0XHR9XG5cdH1cblxuXHQvLyBMb2FkIHNldHRpbmdzIGZyb20gc3RvcmFnZVxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHQvLyBTYXZlIHNldHRpbmdzIHRvIHN0b3JhZ2Vcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHQvLyBHZW5lcmF0ZSBhIHVuaXF1ZSBuYW1lIGZvciBhbiB1bnRpdGxlZCBub3RlXG5cdGdlbmVyYXRlVW5pcXVlVW50aXRsZWROYW1lKCk6IHN0cmluZyB7XG5cdFx0Y29uc3QgYmFzZU5hbWUgPSBcIlVudGl0bGVkXCI7XG5cdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0Y29uc3QgZXhpc3RpbmdOYW1lcyA9IG5ldyBTZXQoZmlsZXMubWFwKGYgPT4gZi5iYXNlbmFtZSkpO1xuXG5cdFx0aWYgKCFleGlzdGluZ05hbWVzLmhhcyhiYXNlTmFtZSkpIHtcblx0XHRcdHJldHVybiBiYXNlTmFtZTtcblx0XHR9XG5cblx0XHRsZXQgY291bnRlciA9IDE7XG5cdFx0d2hpbGUgKGV4aXN0aW5nTmFtZXMuaGFzKGAke2Jhc2VOYW1lfSAke2NvdW50ZXJ9YCkpIHtcblx0XHRcdGNvdW50ZXIrKztcblx0XHR9XG5cdFx0cmV0dXJuIGAke2Jhc2VOYW1lfSAke2NvdW50ZXJ9YDtcblx0fVxuXG5cdC8vIENyZWF0ZSBhIG5ldyBub3RlXG5cdGFzeW5jIGNyZWF0ZU5ld05vdGUoKSB7XG5cdFx0Y29uc3QgdGl0bGUgPSB0aGlzLmdlbmVyYXRlVW5pcXVlVW50aXRsZWROYW1lKCk7XG5cdFx0Y29uc3QgZmlsZVBhdGggPSBgJHt0aXRsZX0ubWRgO1xuXHRcdGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmlsZVBhdGgsIFwiXCIpO1xuXHRcdGF3YWl0IHRoaXMuYWRkVG9EYXRhYmFzZShmaWxlKTtcblx0XHR0aGlzLm9wZW5Ob3RlSW5OZXdUYWIoZmlsZVBhdGgpO1xuXHR9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBUU87QUFJUCxJQUFNLHNCQUFzQjtBQWlCNUIsSUFBTSxtQkFBcUM7QUFBQSxFQUMxQyxXQUFXO0FBQUEsRUFDWCxTQUFTLENBQUM7QUFBQSxFQUNWLFdBQVc7QUFBQSxFQUNYLGdCQUFnQjtBQUNqQjtBQUtBLFNBQVMsbUJBQW1CLEtBQVUsV0FBaUM7QUFDdEUsUUFBTSxTQUFTLFVBQVUsUUFBUSwyQkFBMkIsRUFBRSxFQUFFLFlBQVk7QUFDNUUsUUFBTSxhQUFhLElBQUksTUFBTSxTQUFTLEVBQUUsT0FBTyxPQUFLLDBCQUEwQixLQUFLLEVBQUUsSUFBSSxDQUFDO0FBQzFGLGFBQVcsUUFBUSxZQUFZO0FBQzlCLFFBQUksS0FBSyxTQUFTLFlBQVksTUFBTSxRQUFRO0FBQzNDLGFBQU87QUFBQSxJQUNSO0FBQUEsRUFDRDtBQUNBLFNBQU87QUFDUjtBQUdBLFNBQVMsU0FBUyxJQUE4QixRQUFRLEtBQStCO0FBQ3RGLE1BQUk7QUFDSixTQUFPLElBQUksU0FBZ0I7QUFDMUIsaUJBQWEsS0FBSztBQUNsQixZQUFRLFdBQVcsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLEtBQUs7QUFBQSxFQUM1QztBQUNEO0FBRUEsSUFBTSxlQUFOLGNBQTJCLHlCQUFTO0FBQUEsRUFJbkMsWUFBWSxNQUFxQixRQUFrQjtBQUNsRCxVQUFNLElBQUk7QUFDVixTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEs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
